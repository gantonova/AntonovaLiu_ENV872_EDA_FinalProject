---
title: "VUStats Data Exploration"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Load the Data}

#Load the data
View(Visitation_by_Month)
library(readr)
Visitation_by_Month <- read_csv("Visitation by Month.csv")
getwd()
```
```{r Wrangle the data}
#Pivot Longer to create a tidy dataset
library(tidyverse)

# Gather nutrient data into one column using pivot_longer
Visitation_by_month_gathered <- Visitation_by_Month %>%
  pivot_longer(JAN:DEC, names_to = "Month", values_to = "Recreational_Visits")

#Create a date column

library(lubridate)
paste(Visitation_by_month_gathered$Year,Visitation_by_month_gathered$Month, sep="-")
paste(Visitation_by_month_gathered$Year, Visitation_by_month_gathered$Month, "1", sep="-")

Visitation_by_month_gathered$Date <- ymd( paste(Visitation_by_month_gathered$Year, Visitation_by_month_gathered$Month, "1", sep="-") )
head(Visitation_by_month_gathered)

Visitation_by_month_gathered <- filter(Visitation_by_month_gathered, Year > 1998 & Year < 2020 )

```
```{r Data Exploration, echo=TRUE}

library(ggplot2)
head(Visitation_by_month_gathered)
summary(Visitation_by_month_gathered$Recreational_Visits)

Visitation_by_month_plot <- ggplot(Visitation_by_month_gathered, aes(x = Date, y = Recreational_Visits)) +
  geom_point()+
  geom_smooth()
print(Visitation_by_month_plot)

visitatation_by_month_plot2 <- ggplot(Visitation_by_month_gathered, aes(x = Month, y = Recreational_Visits, label=TRUE, abbr=TRUE, group=factor(Year), color=factor(Year))) +
  geom_line() +
  geom_point() +
  labs(x="Month", colour="Year", y = "Recreationa Visits")
print(visitatation_by_month_plot2)



```

